(this["webpackJsonpreact-express-starter"]=this["webpackJsonpreact-express-starter"]||[]).push([[0],{183:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(66),o=a.n(c),l=(a(73),a(74),a(13)),i=a.n(l),u=a(26),s=a(6),m=({username:e,handleUsernameChange:t,roomName:a,handleRoomNameChange:n,handleSubmit:c})=>r.a.createElement("form",{onSubmit:c},r.a.createElement("h2",null,"Enter a room"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"name"},"Name:"),r.a.createElement("input",{type:"text",id:"field",value:e,onChange:t,required:!0})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"room"},"Room name:"),r.a.createElement("input",{type:"text",id:"room",value:a,onChange:n,required:!0})),r.a.createElement("button",{type:"submit"},"Submit")),d=a(67),p=a.n(d),b=({participant:e})=>{var t=Object(n.useState)([]),a=Object(s.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)([]),i=Object(s.a)(l,2),u=i[0],m=i[1],d=Object(n.useRef)(),p=Object(n.useRef)(),b=e=>Array.from(e.values()).map(e=>e.track).filter(e=>null!==e);return Object(n.useEffect)(()=>{o(b(e.videoTracks)),m(b(e.audioTracks));return e.on("trackSubscribed",e=>{"video"===e.kind?o(t=>[...t,e]):"audio"===e.kind&&m(t=>[...t,e])}),e.on("trackUnsubscribed",e=>{"video"===e.kind?o(t=>t.filter(t=>t!==e)):"audio"===e.kind&&m(t=>t.filter(t=>t!==e))}),()=>{o([]),m([]),e.removeAllListeners()}},[e]),Object(n.useEffect)(()=>{var e=c[0];if(e)return e.attach(d.current),()=>{e.detach()}},[c]),Object(n.useEffect)(()=>{var e=u[0];if(e)return e.attach(p.current),()=>{e.detach()}},[u]),r.a.createElement("div",{className:"participant"},r.a.createElement("h3",null,e.identity),r.a.createElement("video",{ref:d,autoPlay:!0}),r.a.createElement("audio",{ref:p,autoPlay:!0,muted:!1}))},h="\u05e1\u05d2\u05d5\u05e8 \u05de\u05d9\u05e7\u05e8\u05d5\u05e4\u05d5\u05df",f=({roomName:e,token:t,handleLogout:a})=>{var c=Object(n.useState)(null),o=Object(s.a)(c,2),l=o[0],i=o[1],u=Object(n.useState)([]),m=Object(s.a)(u,2),d=m[0],f=m[1],E=Object(n.useState)(h),v=Object(s.a)(E,2),j=v[0],O=v[1],k=Object(n.useState)("\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4"),y=Object(s.a)(k,2),g=y[0],S=y[1];Object(n.useEffect)(()=>{var a=e=>{f(t=>[...t,e])},n=e=>{f(t=>t.filter(t=>t!==e))};return p.a.connect(t,{name:e}).then(e=>{i(e),e.on("participantConnected",a),e.on("participantDisconnected",n),e.participants.forEach(a)}),()=>{i(e=>e&&"connected"===e.localParticipant.state?(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect(),null):e)}},[e,t]);var w=d.map(e=>r.a.createElement(b,{key:e.sid,participant:e}));return r.a.createElement("div",{className:"room"},r.a.createElement("div",null,r.a.createElement("div",{className:"remote-participants"},w),r.a.createElement("div",{className:"local-participant"},l?r.a.createElement(b,{key:l.localParticipant.sid,participant:l.localParticipant}):"")),r.a.createElement("div",null,r.a.createElement("h2",null,"Meeting Id: ",e),r.a.createElement("span",null,r.a.createElement("button",{onClick:()=>{l.localParticipant.audioTracks.forEach((function(e,t){j==h?t.disable():t.enable()})),O(j==h?"\u05e4\u05ea\u05d7 \u05de\u05d9\u05e7\u05e8\u05d5\u05e4\u05d5\u05df":h)}},j)),r.a.createElement("br",null),r.a.createElement("span",null,r.a.createElement("button",{onClick:()=>{l.localParticipant.viseoTracks.forEach((function(e,t){"\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4"==g?t.disable():t.enable()})),S("\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4"==g?"\u05e4\u05ea\u05d7 \u05de\u05e6\u05dc\u05de\u05d4":"\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4")}},g))))},E=e=>new URL(window.location.href).searchParams.get(e),v=()=>{var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),l=Object(s.a)(o,2),d=l[0],p=l[1],b=Object(n.useState)(null),h=Object(s.a)(b,2),v=h[0],j=h[1],O=Object(n.useCallback)(e=>{c(e.target.value)},[]),k=Object(n.useCallback)(e=>{p(e.target.value)},[]),y=Object(n.useCallback)(function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("/video/token",{method:"POST",body:JSON.stringify({identity:a,room:d}),headers:{"Content-Type":"application/json"}}).then(e=>e.json());case 3:n=e.sent,j(n.token);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,a]),g=Object(n.useCallback)(e=>{j(null)},[]),S=E("roomName"),w=E("name"),C=function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/video/token",{method:"POST",body:JSON.stringify({identity:w,room:S}),headers:{"Content-Type":"application/json"}}).then(e=>e.json());case 2:t=e.sent,j(t.token);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return console.log(S+" "+w),null!=S&&null!=w&&C(),v?r.a.createElement(f,{roomName:d,token:v,handleLogout:g}):r.a.createElement(m,{username:a,roomName:d,handleUsernameChange:O,handleRoomNameChange:k,handleSubmit:y})},j=()=>r.a.createElement("div",{className:"app"},r.a.createElement("main",null,r.a.createElement(v,null)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})},68:function(e,t,a){e.exports=a(183)},73:function(e,t,a){},74:function(e,t,a){}},[[68,1,2]]]);
//# sourceMappingURL=main.4af02657.chunk.js.map